<!doctype html>
<html lang=en>
  <head>
    <meta charset=utf-8>
    <title>LINE Login</title>
  </head>
  <body>
    <div id="line-profile"></div>
    <script>
      function handleRedirect() {
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
        const xhr = new XMLHttpRequest();
        xhr.open('POST', 'https://api.line.me/oauth2/v2.1/token');
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.onload = function() {
          if (xhr.status === 200) {
            const response = JSON.parse(xhr.responseText);
            getLineProfile(response.access_token);
          }
        };
        xhr.send('grant_type=authorization_code&code=' + code + '&redirect_uri=https://your-redirect-uri.com&client_id=your-client-id&client_secret=your-client-secret');
      }

      function getLineProfile(access_token) {
        const xhr = new XMLHttpRequest();
        xhr.open('GET', 'https://api.line.me/v2/profile');
        xhr.setRequestHeader('Authorization', 'Bearer ' + access_token);
        xhr.onload = function() {
          if (xhr.status === 200) {
            const profile = JSON.parse(xhr.responseText);
            const lineProfileElement = document.getElementById('line-profile');
            lineProfileElement.innerHTML = '<p>LINEユーザーID: ' + profile.userId + '</p><p>LINE名前: ' + profile.displayName + '</p>';
          }
        };
        xhr.send();
      }

      handleRedirect();
    </script>
  </body>
</html>
